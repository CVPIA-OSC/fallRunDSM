
run_model <- function() {
  set.seed(2021)
  seeded_adults <- fall_run_model()
  output <- fall_run_model(seeds = seeded_adults, mode = "simulate")
  return(output)
}
expected_model_output <- list(spawners = structure(c(33712, 7082, 59224, 4801, 4140, 1801,
                                                     8669, 9143, 33615, 1254, 3831, 911, 3563, 9961, 11221, 0, 0,
                                                     1551, 207279, 32199, 0, 0, 80814, 0, 670, 611, 12678, 5952, 6627,
                                                     4528, 0, 19399, 9361, 16914, 6139, 5275, 1835, 6979, 8298, 46782,
                                                     1170, 4951, 898, 4588, 14083, 14645, 0, 0, 2341, 68030, 9572,
                                                     0, 0, 45530, 0, 649, 619, 4294, 2119, 2595, 2216, 0, 24923, 6758,
                                                     36380, 4573, 3937, 2018, 7125, 6368, 29180, 1163, 3184, 905,
                                                     3407, 9010, 9806, 0, 0, 1923, 124649, 19628, 0, 0, 69269, 0,
                                                     562, 598, 7197, 3884, 4499, 3646, 0, 12784, 3253, 18941, 2278,
                                                     2143, 1828, 3975, 2898, 9991, 749, 1342, 573, 1720, 3234, 4494,
                                                     0, 0, 849, 60733, 10109, 0, 0, 78521, 0, 428, 395, 3649, 2081,
                                                     2574, 4599, 0, 24482, 3320, 45622, 2459, 2257, 2063, 5812, 6719,
                                                     12173, 1136, 1801, 921, 1873, 3900, 5073, 0, 0, 1192, 156724,
                                                     24423, 0, 0, 97146, 0, 621, 681, 9331, 4823, 5283, 4854, 0, 28068,
                                                     7977, 41597, 5372, 4799, 2809, 7655, 17150, 36628, 1744, 4918,
                                                     1341, 4103, 11878, 12784, 0, 0, 2961, 157824, 22573, 0, 0, 103266,
                                                     0, 990, 1177, 9303, 4624, 5203, 4436, 0, 37620, 10955, 55448,
                                                     7128, 6142, 2922, 9546, 23137, 52412, 2021, 6790, 1564, 5496,
                                                     16944, 16617, 0, 0, 3908, 204994, 30096, 0, 0, 115109, 0, 1100,
                                                     1324, 12130, 6022, 7068, 4023, 0, 29898, 6715, 49827, 4453, 3948,
                                                     2135, 7487, 12916, 29873, 1444, 3628, 1071, 3546, 9693, 10101,
                                                     0, 0, 2435, 173516, 26956, 0, 0, 89844, 0, 727, 712, 10193, 5052,
                                                     6598, 2521, 0, 26816, 2288, 53824, 1593, 1541, 1172, 5307, 5745,
                                                     8226, 951, 1156, 682, 1235, 2522, 3225, 0, 0, 987, 179904, 29601,
                                                     0, 0, 81645, 0, 482, 361, 10632, 5485, 6244, 2357, 0, 31028,
                                                     1236, 65360, 800, 898, 815, 5251, 6684, 5819, 743, 947, 543,
                                                     661, 1482, 1832, 0, 0, 558, 218835, 35564, 0, 0, 90363, 0, 412,
                                                     329, 13237, 6401, 7077, 2482, 0, 20052, 850, 41180, 579, 671,
                                                     644, 3393, 4031, 3679, 554, 642, 353, 500, 1015, 1243, 0, 0,
                                                     402, 138243, 22311, 0, 0, 66748, 0, 323, 290, 8240, 4174, 4379,
                                                     1675, 0, 18335, 1465, 38595, 599, 569, 568, 3158, 2770, 2958,
                                                     452, 363, 356, 503, 872, 1006, 0, 0, 302, 129166, 21099, 0, 0,
                                                     60685, 0, 231, 209, 7618, 3831, 4095, 1454, 0, 23891, 2376, 49292,
                                                     869, 760, 619, 4155, 3583, 4313, 629, 451, 459, 753, 1158, 1325,
                                                     0, 0, 410, 165447, 27210, 0, 0, 67314, 0, 292, 257, 9618, 4797,
                                                     5352, 1866, 0, 29114, 1511, 62649, 623, 544, 584, 4897, 3929,
                                                     3269, 590, 348, 413, 463, 741, 896, 0, 0, 325, 211808, 33938,
                                                     0, 0, 69466, 0, 274, 219, 12194, 6184, 6493, 2277, 0, 15995,
                                                     899, 34916, 497, 459, 418, 2900, 2302, 2444, 452, 315, 284, 440,
                                                     635, 962, 0, 0, 246, 118025, 18883, 0, 0, 48498, 0, 207, 171,
                                                     7031, 3477, 3702, 1335, 0, 30987, 4511, 57927, 3056, 2783, 3119,
                                                     6323, 8246, 16905, 1179, 2319, 900, 2261, 5747, 6133, 0, 0, 1108,
                                                     192612, 31642, 0, 0, 101122, 0, 596, 599, 11029, 5721, 6400,
                                                     2539, 0, 30086, 7542, 44711, 4978, 4566, 5762, 6872, 11842, 28843,
                                                     1772, 4126, 1423, 3742, 10114, 10764, 0, 0, 1827, 147525, 24514,
                                                     0, 0, 130900, 0, 908, 892, 8421, 4567, 5167, 2599, 0, 14437,
                                                     6615, 15765, 4090, 3472, 3714, 4094, 12926, 26982, 1158, 3842,
                                                     1039, 3102, 8646, 9223, 0, 0, 1259, 51842, 8804, 0, 0, 108761,
                                                     0, 735, 733, 3062, 1823, 2115, 1331, 0, 12837, 7561, 15541, 4520,
                                                     3899, 2662, 4130, 17870, 31659, 1200, 4426, 1036, 3388, 9204,
                                                     10356, 0, 0, 1190, 49422, 8427, 0, 0, 105228, 0, 813, 863, 3158,
                                                     1944, 2213, 1601, 0, 28167, 6357, 52677, 4080, 3601, 2957, 6645,
                                                     14425, 24765, 1280, 3322, 1007, 2992, 7206, 8756, 0, 0, 1170,
                                                     173021, 27892, 0, 0, 116843, 0, 763, 658, 10311, 5352, 5797,
                                                     2952, 0),
                                                   .Dim = c(31L, 20L),
                                                   .Dimnames = list(c("Upper Sacramento River",
                                                                      "Antelope Creek", "Battle Creek", "Bear Creek", "Big Chico Creek",
                                                                      "Butte Creek", "Clear Creek", "Cottonwood Creek", "Cow Creek",
                                                                      "Deer Creek", "Elder Creek", "Mill Creek", "Paynes Creek", "Stony Creek",
                                                                      "Thomes Creek", "Upper-mid Sacramento River", "Sutter Bypass",
                                                                      "Bear River", "Feather River", "Yuba River", "Lower-mid Sacramento River",
                                                                      "Yolo Bypass", "American River", "Lower Sacramento River", "Calaveras River",
                                                                      "Cosumnes River", "Mokelumne River", "Merced River", "Stanislaus River",
                                                                      "Tuolumne River", "San Joaquin River"), c("1", "2", "3", "4",
                                                                                                                "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15",
                                                                                                                "16", "17", "18", "19", "20"))))

test_that("The full model results remain the same (with a set seed)", {
  expect_equal(run_model()[1], expected_model_output)
})
