library(testthat)
library(springRunDSM)

run_model <- function() {
  set.seed(2021)
  seeded_adults <- spring_run_model(mode = "seed")
  output <- spring_run_model(seeds = seeded_adults, mode = "simulate")
  return(output)
}
expected_model_output <- list(spawners = structure(c(2915, 651, 1200, 0, 573, 8365, 738,
                                                     85, 0, 1774, 0, 2041, 0, 0, 58, 0, 0, 0, 14299, 1670, 0, 0, 0,
                                                     0, 70, 65, 57, 65, 56, 68, 0, 1253, 228, 817, 0, 216, 2801, 545,
                                                     40, 0, 663, 0, 1058, 0, 0, 29, 0, 0, 0, 10451, 1068, 0, 0, 0,
                                                     0, 23, 21, 29, 26, 31, 22, 0, 562, 187, 283, 0, 189, 3279, 152,
                                                     18, 0, 689, 0, 581, 0, 0, 23, 0, 0, 0, 6156, 1046, 0, 0, 0, 0,
                                                     19, 20, 16, 18, 15, 19, 0, 1300, 451, 246, 0, 493, 8489, 208,
                                                     55, 0, 1614, 0, 1058, 0, 0, 31, 0, 0, 0, 5529, 1387, 0, 0, 0,
                                                     0, 51, 42, 48, 35, 47, 30, 0, 2163, 641, 537, 0, 677, 10624,
                                                     375, 58, 0, 2284, 0, 1646, 0, 0, 50, 0, 0, 0, 8228, 1658, 0,
                                                     0, 0, 0, 58, 59, 46, 54, 71, 69, 0, 1632, 451, 663, 0, 468, 6306,
                                                     479, 69, 0, 1540, 0, 1420, 0, 0, 45, 0, 0, 0, 9529, 1131, 0,
                                                     0, 0, 0, 49, 48, 43, 46, 49, 29, 0, 884, 258, 663, 0, 233, 3366,
                                                     415, 59, 0, 928, 0, 1076, 0, 0, 49, 0, 0, 0, 11116, 880, 0, 0,
                                                     0, 0, 37, 40, 40, 43, 37, 46, 0, 410, 139, 350, 0, 140, 1973,
                                                     210, 24, 0, 531, 0, 573, 0, 0, 10, 0, 0, 0, 8902, 963, 0, 0,
                                                     0, 0, 12, 27, 24, 14, 22, 16, 0, 172, 48, 117, 0, 40, 674, 55,
                                                     6, 0, 179, 0, 174, 0, 0, 6, 0, 0, 0, 5273, 817, 0, 0, 0, 0, 4,
                                                     2, 4, 9, 4, 4, 0, 139, 45, 100, 0, 32, 701, 46, 4, 0, 152, 0,
                                                     110, 0, 0, 3, 0, 0, 0, 6780, 1011, 0, 0, 0, 0, 4, 5, 4, 0, 1,
                                                     3, 0, 148, 35, 81, 0, 37, 532, 38, 5, 0, 138, 0, 95, 0, 0, 5,
                                                     0, 0, 0, 6514, 859, 0, 0, 0, 0, 0, 2, 1, 2, 3, 3, 0, 150, 25,
                                                     110, 0, 33, 385, 50, 7, 0, 104, 0, 123, 0, 0, 2, 0, 0, 0, 5614,
                                                     792, 0, 0, 0, 0, 3, 3, 4, 3, 3, 1, 0, 95, 15, 63, 0, 15, 272,
                                                     31, 1, 0, 88, 0, 80, 0, 0, 6, 0, 0, 0, 5049, 693, 0, 0, 0, 0,
                                                     4, 2, 3, 5, 2, 1, 0, 67, 15, 68, 0, 23, 378, 16, 4, 0, 94, 0,
                                                     57, 0, 0, 7, 0, 0, 0, 6121, 727, 0, 0, 0, 0, 4, 5, 5, 5, 5, 6,
                                                     0, 398, 49, 262, 0, 38, 1072, 75, 16, 0, 242, 0, 314, 0, 0, 8,
                                                     0, 0, 0, 8387, 856, 0, 0, 0, 0, 7, 8, 9, 6, 11, 9, 0, 811, 54,
                                                     412, 0, 48, 1576, 116, 12, 0, 347, 0, 491, 0, 0, 15, 0, 0, 0,
                                                     6936, 838, 0, 0, 0, 0, 9, 12, 13, 16, 13, 13, 0, 765, 70, 409,
                                                     0, 54, 1501, 134, 22, 0, 355, 0, 456, 0, 0, 13, 0, 0, 0, 5697,
                                                     794, 0, 0, 0, 0, 10, 5, 17, 8, 2, 11, 0, 1351, 304, 659, 0, 231,
                                                     7314, 374, 32, 0, 1109, 0, 971, 0, 0, 50, 0, 0, 0, 7033, 776,
                                                     0, 0, 0, 0, 42, 49, 43, 38, 27, 44, 0, 1748, 671, 739, 0, 636,
                                                     15917, 470, 73, 0, 2418, 0, 1834, 0, 0, 78, 0, 0, 0, 9540, 1210,
                                                     0, 0, 0, 0, 76, 88, 70, 74, 75, 70, 0, 1669, 978, 717, 0, 975,
                                                     17008, 431, 96, 0, 3522, 0, 2332, 0, 0, 79, 0, 0, 0, 9896, 2065,
                                                     0, 0, 0, 0, 92, 77, 74, 81, 79, 67, 0), .Dim = c(31L, 20L), .Dimnames = list(
                                                       c("Upper Sacramento River", "Antelope Creek", "Battle Creek",
                                                         "Bear Creek", "Big Chico Creek", "Butte Creek", "Clear Creek",
                                                         "Cottonwood Creek", "Cow Creek", "Deer Creek", "Elder Creek",
                                                         "Mill Creek", "Paynes Creek", "Stony Creek", "Thomes Creek",
                                                         "Upper-mid Sacramento River", "Sutter Bypass", "Bear River",
                                                         "Feather River", "Yuba River", "Lower-mid Sacramento River",
                                                         "Yolo Bypass", "American River", "Lower Sacramento River",
                                                         "Calaveras River", "Cosumnes River", "Mokelumne River", "Merced River",
                                                         "Stanislaus River", "Tuolumne River", "San Joaquin River"
                                                       ), c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11",
                                                            "12", "13", "14", "15", "16", "17", "18", "19", "20"))))
test_that("The full model results remain the same (with a set seed)", {
  expect_equal(run_model()[1], expected_model_output)
})
